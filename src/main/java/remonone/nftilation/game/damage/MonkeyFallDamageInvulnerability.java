package remonone.nftilation.game.damage;

import org.apache.commons.lang.StringUtils;
import org.bukkit.entity.Player;
import org.bukkit.event.entity.EntityDamageEvent;
import remonone.nftilation.constants.PropertyConstant;
import remonone.nftilation.game.models.PlayerModel;
import remonone.nftilation.game.roles.Monkey;
import remonone.nftilation.game.roles.Role;
import remonone.nftilation.utils.PlayerUtils;

public class MonkeyFallDamageInvulnerability extends BaseDamageHandler {

    @Override
    public int getPriority() {
        return 1;
    }

    @Override
    public void OnDamageHandle(EntityDamageEvent e) {
        if(!e.getCause().equals(EntityDamageEvent.DamageCause.FALL)) return;
        Player player = (Player) e.getEntity();
        PlayerModel model = PlayerUtils.getModelFromPlayer(player);
        String roleId = (String)model.getParameters().get(PropertyConstant.PLAYER_ROLE_ID);
        if(StringUtils.isBlank(roleId)) return;
        Role role = Role.getRoleByID(roleId);
        if(!(role instanceof Monkey)) return;
        e.setCancelled(true);
    }
}
